
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>LC-MS/MS Data Preprocessing and Deconvolution &#8212; glycresoft  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Building a Combinatorial Glycan Hypothesis" href="combinatorial-glycan.html" />
    <link rel="prev" title="Command Line Applications" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class='logo'>
    <a href="../index.html">
        <img class="logo" src="../_static/img/logo.png" style="width: 120px;"><br>
        <span class='logo-title' style='text-align: center;'>glycresoft</span>
    </a>
</p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">LC-MS/MS Data Preprocessing and Deconvolution</a><ul>
<li><a class="reference internal" href="#glycresoft-mzml-preprocess">glycresoft mzml preprocess</a></li>
<li><a class="reference internal" href="#usage-example">Usage example</a></li>
<li><a class="reference internal" href="#averagine-models">Averagine Models</a><ul>
<li><a class="reference internal" href="#builtin-models">Builtin Models</a></li>
</ul>
</li>
<li><a class="reference internal" href="#supported-file-formats">Supported File Formats</a></li>
<li><a class="reference internal" href="#signal-filters">Signal Filters</a></li>
<li><a class="reference internal" href="#output-information">Output Information</a></li>
<li><a class="reference internal" href="#bibliography">Bibliography</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Command Line Applications</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Command Line Applications</a></li>
      <li>Next: <a href="combinatorial-glycan.html" title="next chapter">Building a Combinatorial Glycan Hypothesis</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/cli-apps/mzml-preprocess.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="lc-ms-ms-data-preprocessing-and-deconvolution">
<h1>LC-MS/MS Data Preprocessing and Deconvolution<a class="headerlink" href="#lc-ms-ms-data-preprocessing-and-deconvolution" title="Permalink to this headline">¶</a></h1>
<p>Convert raw mass spectral data files into deisotoped neutral mass peak lists
written to a new <strong>mzML</strong> <a class="reference internal" href="#martens2011" id="id1">[Martens2011]</a> file. For tandem mass spectra,
recalculate precursor ion monoisotopic peaks.</p>
<p>This task is computationally intensive, and uses several collaborative processes
to share the work.</p>
<div class="section" id="glycresoft-mzml-preprocess">
<h2>glycresoft mzml preprocess<a class="headerlink" href="#glycresoft-mzml-preprocess" title="Permalink to this headline">¶</a></h2>
<p>Convert raw mass spectra data into deisotoped neutral mass peak lists written to mzML.</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>glycresoft mzml preprocess <span class="o">[</span>OPTIONS<span class="o">]</span> MS_FILE OUTFILE_PATH
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-a">
<code class="descname">-a</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--averagine</code><code class="descclassname"> &lt;averagine&gt;</code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-a" title="Permalink to this definition">¶</a></dt>
<dd><p>Averagine model to use for MS1 scans. Either a name or formula  [default: glycan] (May specify more than once)</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-an">
<code class="descname">-an</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--msn-averagine</code><code class="descclassname"> &lt;averagine&gt;</code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-an" title="Permalink to this definition">¶</a></dt>
<dd><p>Averagine model to use for MS^n scans. Either a name or formula  [default: peptide]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-s">
<code class="descname">-s</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--start-time</code><code class="descclassname"> &lt;float&gt;</code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-s" title="Permalink to this definition">¶</a></dt>
<dd><p>Scan time to begin processing at in minutes  [default: 0.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-e">
<code class="descname">-e</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--end-time</code><code class="descclassname"> &lt;float&gt;</code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-e" title="Permalink to this definition">¶</a></dt>
<dd><p>Scan time to stop processing at in minutes  [default: inf]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-c">
<code class="descname">-c</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--maximum-charge</code><code class="descclassname"> &lt;int&gt;</code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-c" title="Permalink to this definition">¶</a></dt>
<dd><p>Highest absolute charge state to consider  [default: 8]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-n">
<code class="descname">-n</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--name</code><code class="descclassname"> &lt;string&gt;</code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-n" title="Permalink to this definition">¶</a></dt>
<dd><p>Name for the sample run to be stored. Defaults to the base name of the input mzML file</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-t">
<code class="descname">-t</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--score-threshold</code><code class="descclassname"> &lt;float&gt;</code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-t" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum score to accept an isotopic pattern fit in an MS1 scan  [default: 20.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-tn">
<code class="descname">-tn</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--msn-score-threshold</code><code class="descclassname"> &lt;float&gt;</code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-tn" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum score to accept an isotopic pattern fit in an MS^n scan  [default: 10.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-m">
<code class="descname">-m</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--missed-peaks</code><code class="descclassname"> &lt;int&gt;</code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-m" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of missing peaks to permit before an isotopic fit is discarded  [default: 3]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-mn">
<code class="descname">-mn</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--msn-missed-peaks</code><code class="descclassname"> &lt;int&gt;</code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-mn" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of missing peaks to permit before an isotopic fit is discarded in an MSn scan  [default: 1]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-p">
<code class="descname">-p</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--processes</code><code class="descclassname"> &lt;int&gt;</code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-p" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of worker processes to use. Defaults to 4 or the number of CPUs, whichever is lower  [default: 4]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-b">
<code class="descname">-b</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--background-reduction</code><code class="descclassname"> &lt;float&gt;</code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-b" title="Permalink to this definition">¶</a></dt>
<dd><p>Background reduction factor. Larger values more aggresively remove low abundance signal in MS1 scans.  [default: 5.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-bn">
<code class="descname">-bn</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--msn-background-reduction</code><code class="descclassname"> &lt;float&gt;</code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-bn" title="Permalink to this definition">¶</a></dt>
<dd><p>Background reduction factor. Larger values more aggresively remove low abundance signal in MS^n scans.  [default: 0.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-r">
<code class="descname">-r</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--transform</code><code class="descclassname"> &lt;choice&gt;</code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-r" title="Permalink to this definition">¶</a></dt>
<dd><p>Scan transformations to apply to MS1 scans. May specify more than once. (May specify more than once)</p>
<div class="line-block">
<div class="line">Choices: [</div>
<div class="line-block">
<div class="line">extreme_scale_limiter; fticr_baseline; gaussian_smooth;</div>
<div class="line">linear_resampling; mean_below_mean; median;</div>
<div class="line">one_percent_of_max; over_10; over_100;</div>
<div class="line">savitsky_golay; tenth_percent_of_max]</div>
</div>
</div>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-rn">
<code class="descname">-rn</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--msn-transform</code><code class="descclassname"> &lt;choice&gt;</code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-rn" title="Permalink to this definition">¶</a></dt>
<dd><p>Scan transformations to apply to MS^n scans. May specify more than once. (May specify more than once)</p>
<div class="line-block">
<div class="line">Choices: [</div>
<div class="line-block">
<div class="line">extreme_scale_limiter; fticr_baseline; gaussian_smooth;</div>
<div class="line">linear_resampling; mean_below_mean; median;</div>
<div class="line">one_percent_of_max; over_10; over_100;</div>
<div class="line">savitsky_golay; tenth_percent_of_max]</div>
</div>
</div>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-v">
<code class="descname">-v</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--extract-only-tandem-envelopes</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-v" title="Permalink to this definition">¶</a></dt>
<dd><p>Only work on regions that will be chosen for MS/MS  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-g">
<code class="descname">-g</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--ms1-averaging</code><code class="descclassname"> &lt;int&gt;</code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-g" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of MS1 scans before and after the current MS1 scan to average when picking peaks.  [default: 0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-ignore-msn">
<code class="descname">--ignore-msn</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-ignore-msn" title="Permalink to this definition">¶</a></dt>
<dd><p>Ignore MS^n scans  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-signal-to-noise-threshold">
<code class="descname">-n</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--signal-to-noise-threshold</code><code class="descclassname"> &lt;float&gt;</code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-signal-to-noise-threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Signal-to-noise ratio threshold to apply when filtering peaks  [default: 1.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-mo">
<code class="descname">-mo</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--mass-offset</code><code class="descclassname"> &lt;float&gt;</code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-mo" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift peak masses by the given amount  [default: 0.0]</p>
</dd></dl>

<p class="rubric">Arguments</p>
<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-arg-ms-file">
<code class="descname">MS_FILE</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-arg-ms-file" title="Permalink to this definition">¶</a></dt>
<dd><p>Required argument
&lt;path&gt; Path to an mass spectral data file in one of the supported formats</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-glycresoft-mzml-preprocess-arg-outfile-path">
<code class="descname">OUTFILE_PATH</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-glycresoft-mzml-preprocess-arg-outfile-path" title="Permalink to this definition">¶</a></dt>
<dd><p>Required argument
&lt;path&gt; Path to write the processed output to</p>
</dd></dl>

</div>
<div class="section" id="usage-example">
<h2>Usage example<a class="headerlink" href="#usage-example" title="Permalink to this headline">¶</a></h2>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">example usage</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-bash"><div class="highlight"><pre><span></span>glycresoft-cli mzml preprocess -a permethylated-glycan -t <span class="m">20</span> -p <span class="m">6</span> <span class="se">\</span>
    -s <span class="m">5</span>.0 -e <span class="m">60</span>.0 <span class="s2">&quot;path/to/input&quot;</span> <span class="s2">&quot;path/to/output.mzML&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="averagine-models">
<h2>Averagine Models<a class="headerlink" href="#averagine-models" title="Permalink to this headline">¶</a></h2>
<p>Argument type for <code class="docutils literal"><span class="pre">&lt;averagine&gt;</span></code>. The model selected influences how isotopic
patterns are estimated for an arbitrary mass. The value of this parameter may
be a builtin model name or a formula.</p>
<p>For a more complete discsussion of how “averagine” isotopic models work, see <a class="reference internal" href="#senko1995" id="id2">[Senko1995]</a>.</p>
<div class="section" id="builtin-models">
<h3>Builtin Models<a class="headerlink" href="#builtin-models" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="48%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Model Name</th>
<th class="head">Formula</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>heparin</td>
<td>H10C6S0.5O5.5N0.5</td>
</tr>
<tr class="row-odd"><td>peptide</td>
<td>H7.8C4.9S0.042O1.5N1.4</td>
</tr>
<tr class="row-even"><td>heparan-sulfate</td>
<td>H11C6S1.3O9N0.67</td>
</tr>
<tr class="row-odd"><td>permethylated-glycan</td>
<td>H22C12O5.2N0.5</td>
</tr>
<tr class="row-even"><td>glycan</td>
<td>H12C7O5.2N0.5</td>
</tr>
<tr class="row-odd"><td>glycopeptide</td>
<td>H16C11S0.021O6.5N1.7</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="supported-file-formats">
<h2>Supported File Formats<a class="headerlink" href="#supported-file-formats" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">MS_FILE</span></code> may be in mzML or mzXML format.</p>
</div>
<div class="section" id="signal-filters">
<h2>Signal Filters<a class="headerlink" href="#signal-filters" title="Permalink to this headline">¶</a></h2>
<p>Prior to picking peaks, the raw mass spectral signal may be filtered a number
of ways. By default, a local noise reduction filter is applied, modulated by
<code class="docutils literal"><span class="pre">-b</span></code> and <code class="docutils literal"><span class="pre">-bn</span></code> options respectively. Other filers may be set using <code class="docutils literal"><span class="pre">-r</span></code>
and <code class="docutils literal"><span class="pre">-rn</span></code>:</p>
<ol class="arabic simple">
<li><code class="docutils literal"><span class="pre">mean_below_mean</span></code> - Remove all points below the mean of all points below the mean of all unfiltered points of this scan</li>
<li><code class="docutils literal"><span class="pre">median</span></code> - Remove all points below the median intensity of this scan</li>
<li><code class="docutils literal"><span class="pre">one_percent_of_max</span></code> - Remove all points with intensity less than 1% of the maximum intensity point of this scan</li>
<li><code class="docutils literal"><span class="pre">fticr_baseline</span></code> - Apply the same background reduction algorithm used by <code class="docutils literal"><span class="pre">-b</span></code> and <code class="docutils literal"><span class="pre">-bn</span></code></li>
<li><code class="docutils literal"><span class="pre">savitsky_golay</span></code> - Apply Savtisky-Golay smoothing on the intensities of this scan</li>
</ol>
</div>
<div class="section" id="output-information">
<h2>Output Information<a class="headerlink" href="#output-information" title="Permalink to this headline">¶</a></h2>
<p>The resulting mzML file from this tool attempts to preserve as much metadata as possible
from the source data file, and records its own metadata in the appropriate sections of
the document.</p>
<p>Each scan has a standard set of <code class="docutils literal"><span class="pre">cvParam</span></code> entries covering scan polarity,
peak mode, and MS level. In addition to the normal <code class="docutils literal"><span class="pre">m/z</span> <span class="pre">array</span></code> and <code class="docutils literal"><span class="pre">intensity</span> <span class="pre">array</span></code>
entries, each scan also includes the standardized <code class="docutils literal"><span class="pre">charge</span> <span class="pre">array</span></code>, as well as two non-standard
arrays, <code class="docutils literal"><span class="pre">deconvolution</span> <span class="pre">score</span> <span class="pre">array</span></code> and <code class="docutils literal"><span class="pre">isotopic</span> <span class="pre">envelopes</span> <span class="pre">array</span></code>. The <code class="docutils literal"><span class="pre">deconvolution</span> <span class="pre">score</span> <span class="pre">array</span></code>
is just the result of the goodness-of-fit function used to evaluate the isotopic envelopes resulting
in the reported peaks. The <code class="docutils literal"><span class="pre">isotopic</span> <span class="pre">envelopes</span> <span class="pre">array</span></code> is more complex, as it encodes the set of isotopic
peaks used to fit each reported peak, and does not have a one-to-one relationship with other arrays.</p>
<p>To unpack the <code class="docutils literal"><span class="pre">isotopic</span> <span class="pre">envelopes</span> <span class="pre">array</span></code> after decoding, the we use the following logic:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">decode_envelopes</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    array: float32 array</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">envelope_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">current_envelope</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
        <span class="c1"># fetch the next two values</span>
        <span class="n">mz</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">intensity</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>

        <span class="c1"># if both numbers are zero, this denotes the beginning</span>
        <span class="c1"># of a new envelope</span>
        <span class="k">if</span> <span class="n">mz</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">intensity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">current_envelope</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">current_envelope</span><span class="p">:</span>
                    <span class="n">envelope_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Envelope</span><span class="p">(</span><span class="n">current_envelope</span><span class="p">))</span>
                <span class="n">current_envelope</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># otherwise add the current point to the existing envelope</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">current_envelope</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EnvelopePair</span><span class="p">(</span><span class="n">mz</span><span class="p">,</span> <span class="n">intensity</span><span class="p">))</span>
    <span class="n">envelope_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Envelope</span><span class="p">(</span><span class="n">current_envelope</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">envelope_list</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="bibliography">
<h2>Bibliography<a class="headerlink" href="#bibliography" title="Permalink to this headline">¶</a></h2>
<table class="docutils citation" frame="void" id="senko1995" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[Senko1995]</a></td><td>Senko, M. W., Beu, S. C., &amp; McLafferty, F. W. (1995). Determination of
monoisotopic masses and ion populations for large biomolecules from resolved
isotopic distributions.
Journal of the American Society for Mass Spectrometry, 6(4), 229–233.
<a class="reference external" href="https://doi.org/10.1016/1044-0305(95)00017-8">https://doi.org/10.1016/1044-0305(95)00017-8</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="martens2011" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[Martens2011]</a></td><td>Martens, L., Chambers, M., Sturm, M., Kessner, D., Levander, F., Shofstahl, J.,
… Deutsch, E. W. (2011). mzML–a community standard for mass spectrometry data.
Molecular &amp; Cellular Proteomics : MCP, 10(1), R110.000133.
<a class="reference external" href="https://doi.org/10.1074/mcp.R110.000133">https://doi.org/10.1074/mcp.R110.000133</a></td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2017, Joshua Klein.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/cli-apps/mzml-preprocess.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>